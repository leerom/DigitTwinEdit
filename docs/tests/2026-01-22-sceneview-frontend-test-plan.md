# SceneView 键盘鼠标交互系统前端测试方案

## 1. 概述
本方案旨在验证数字孪生三维场景编辑器 SceneView 的键盘鼠标交互功能是否符合设计要求。测试将覆盖相机控制、快捷键响应、工具切换及模式切换等核心交互场景。

## 2. 测试环境
- **浏览器**: Chrome (最新版)
- **分辨率**: 1920x1080
- **输入设备**: 标准键盘 + 三键鼠标（带滚轮）

## 3. 测试范围
- 相机系统 (CameraSystem)
  - 轨道模式 (Orbit Mode)
  - 飞行模式 (Fly Mode)
- 键盘快捷键 (Keyboard Shortcuts)
- 工具交互 (Tools & Gizmo)
- 模式切换与冲突处理

## 4. 详细测试用例

### 4.1. 基础视图操作 (Orbit Mode)
**前置条件**: 默认进入编辑器，处于 Orbit 模式（未按住右键）。

| ID | 测试点 | 操作步骤 | 预期结果 | 备注 |
|---|---|---|---|---|
| TC-01 | 视角旋转 | 按住 `Alt` + `鼠标左键` 拖动 | 场景围绕中心点旋转，相机位置改变 | |
| TC-02 | 视角平移 (中键) | 按住 `鼠标中键` 拖动 | 场景平移，视角方向不变 | |
| TC-03 | 视角平移 (组合键) | 激活 `抓手工具(Q)` + `鼠标左键` 拖动 | 场景平移，效果同中键 | |
| TC-04 | 视角缩放 (滚轮) | 滚动 `鼠标滚轮` | 视角推近/拉远 | |
| TC-05 | 视角缩放 (组合键) | 按住 `Alt` + `鼠标右键` 拖动 | 视角推近/拉远，平滑缩放 | |

### 4.2. 漫游飞行操作 (Fly Mode)
**前置条件**: 场景中有参照物。

| ID | 测试点 | 操作步骤 | 预期结果 | 备注 |
|---|---|---|---|---|
| TC-06 | 进入飞行模式 | 按住 `鼠标右键` 不放 | 1. 鼠标光标隐藏/锁定<br>2. 进入飞行模式状态 | |
| TC-07 | 飞行视角旋转 | (按住右键状态下) 移动鼠标 | 视角随鼠标移动自由旋转 (FPS风格) | |
| TC-08 | 前后左右飞行 | (按住右键状态下) 按住 `W`/`A`/`S`/`D` | 相机向 前/左/后/右 方向平滑移动 | 此时不应触发工具切换 |
| TC-09 | 垂直升降飞行 | (按住右键状态下) 按住 `Q`/`E` | 相机向 下/上 垂直移动 | 此时不应触发工具切换 |
| TC-10 | 加速飞行 | (按住右键+移动键时) 按住 `Shift` | 移动速度显著加快 | |
| TC-11 | 退出飞行模式 | 松开 `鼠标右键` | 1. 鼠标光标恢复显示<br>2. 停止移动<br>3. 回到 Orbit 模式 | |

### 4.3. 工具快捷键与模式冲突
**前置条件**: 场景中选中一个物体。

| ID | 测试点 | 操作步骤 | 预期结果 | 备注 |
|---|---|---|---|---|
| TC-12 | 切换移动工具 | (Orbit模式下) 按 `W` 键 | 左侧工具栏高亮 `Move`，场景显示三轴移动 Gizmo | |
| TC-13 | 切换旋转工具 | (Orbit模式下) 按 `E` 键 | 左侧工具栏高亮 `Rotate`，场景显示旋转球 Gizmo | |
| TC-14 | 切换缩放工具 | (Orbit模式下) 按 `R` 键 | 左侧工具栏高亮 `Scale`，场景显示缩放块 Gizmo | |
| TC-15 | 冲突测试-W键 | 1. 按住 `鼠标右键` (进入飞行)<br>2. 按 `W` 键 | **相机向前移动**，工具栏状态**保持不变** (不切换到移动工具) | 关键测试点 |
| TC-16 | 冲突测试-Q键 | 1. 按住 `鼠标右键` (进入飞行)<br>2. 按 `Q` 键 | **相机向下移动**，工具栏状态**保持不变** (不切换到抓手工具) | 关键测试点 |

### 4.4. 选择与交互
**前置条件**: 场景中有多个物体。

| ID | 测试点 | 操作步骤 | 预期结果 | 备注 |
|---|---|---|---|---|
| TC-17 | 单选物体 | 鼠标左键点击物体 | 物体高亮，Gizmo 显示在物体中心 | |
| TC-18 | 加选物体 | 按住 `Ctrl` + 点击未选物体 | 新物体加入选中列表，Gizmo 位置更新 (通常为中心点) | |
| TC-19 | 空白处取消 | 点击场景空白处 | 所有选中状态取消，Gizmo 消失 | |
| TC-20 | 框选物体 | 鼠标左键拖动画框 | 框内的所有物体被选中 | 需在未激活Gizmo区域操作 |

## 5. 验收标准
1. **流畅性**: 模式切换（Orbit <-> Fly）无卡顿，视角无跳变。
2. **准确性**: 快捷键在不同模式下响应正确，无误触发。
3. **兼容性**: 组合键操作（如 Alt+左键）不与浏览器默认快捷键冲突。
4. **稳定性**: 长时间飞行漫游后，坐标计算依然准确。

## 6. 自动化测试建议 (可选)
对于核心逻辑（如 InputState 更新），建议补充单元测试：
- 模拟 `keydown` 事件，断言 `InputState.keys` 状态更新。
- 模拟 `FlyController` 的 `useFrame`，断言相机位置计算逻辑正确。
