# 测试报告：新建场景功能 UI 测试
**日期**: 2026-01-22
**测试人员**: Claude
**测试结果**: 全部通过 (100%)

## 1. 测试用例执行摘要

| 用例 ID | 名称 | 结果 | 备注 |
| :--- | :--- | :--- | :--- |
| TC-001 | 菜单显示检查 | ✅ 通过 | "新建场景" 选项存在且可见 |
| TC-002 | 新建场景 - 无未保存修改 | ✅ 通过 | 成功创建新场景，重置为默认状态 |
| TC-003 | 新建场景 - 有未保存修改 - 选择保存 | ✅ 通过 | 提示保存对话框，确认保存流程正常 |
| TC-004 | 新建场景 - 有未保存修改 - 选择不保存 | ✅ 通过 | 放弃修改，直接创建新场景成功 |
| TC-005 | 新建场景 - 有未保存修改 - 取消 | ✅ 通过 | 取消操作，停留在当前场景 |
| TC-006 | 新建场景 - 名称验证 | ✅ 通过 | 空名称无法创建，错误提示正常 |
| TC-007 | 新建场景 - 取消创建 | ✅ 通过 | 取消创建对话框，无副作用 |
| TC-008 | 默认对象属性检查 | ✅ 通过 | 相机和灯光的默认位置、参数正确 |
| TC-009 | 场景视图可视化检查 | ✅ 通过 | 对象在 3D 视图和层级视图中同步显示 |

## 2. 缺陷修复记录 (Defects Fixed)

在测试执行过程中，发现并修复了以下问题：

### 2.1 严重缺陷：Hierarchy 面板初始化为空
*   **现象**: 创建新场景或初始加载时，Hierarchy 面板不显示任何子对象（如 Camera, Light），导致无法选择和编辑。
*   **原因**: `src/stores/sceneStore.ts` 中 `DEFAULT_SCENE` 的 `root` 对象 `children` 数组为空，未包含预定义的 `camera-1` 和 `light-1`。
*   **修复**: 更新 `DEFAULT_SCENE` 定义，正确关联初始子对象 ID。

### 2.2 缺陷：Inspector 面板多选渲染错误
*   **现象**: 多选相同类型对象（如多个灯光）时，未能正确显示该类型的特有属性面板。
*   **原因**: `InspectorPanel` 判断逻辑缺陷，且未正确传递 `objectIds` 给子组件。
*   **修复**: 修正 `isAllCameras` / `isAllLights` 判断逻辑，并传递多选 ID 列表。

## 3. 详细执行日志

### TC-002: 基础创建流程
*   点击菜单 "新建场景"。
*   输入 "My New Scene"。
*   验证层级视图出现 "Main Camera" 和 "Directional Light"。

### TC-004: 放弃修改流程
*   修改场景（移动相机）触发 `isDirty=true`。
*   再次点击 "新建场景"。
*   弹出 "保存更改？" 对话框。
*   点击 "不保存"。
*   成功进入新场景名称输入界面。
*   输入 "Discard Scene" 并创建。
*   验证场景已重置。

### TC-008: 属性验证
*   选中 "Main Camera"。
*   Inspector 显示 Position Y: 1, Z: -10, FOV: 60。
*   选中 "Directional Light"。
*   Inspector 显示 Position Y: 3, Rotation X: 50, Y: -30。

## 4. 结论

"新建场景" 功能及相关 UI 交互（菜单、对话框、状态管理）已通过验证，符合设计要求。同时修复了影响测试执行的场景初始化和属性面板显示 Bug。
