# ğŸ”§ é”™è¯¯åˆ†æå’Œä¿®å¤æŠ¥å‘Š

> åˆ†ææ—¶é—´: 2026-02-01
> çŠ¶æ€: âœ… å¤§éƒ¨åˆ†é—®é¢˜å·²ä¿®å¤ï¼Œâ¸ï¸ ç­‰å¾…PostgreSQLå¯åŠ¨

---

## å‘ç°çš„é”™è¯¯

### 1. âŒ bcryptç¼–è¯‘é”™è¯¯

**é”™è¯¯ä¿¡æ¯**:
```
Error: Cannot find module 'bcrypt/lib/binding/napi-v3/bcrypt_lib.node'
Code: MODULE_NOT_FOUND
```

**åŸå› åˆ†æ**:
- bcryptæ˜¯åŸç”ŸNode.jsæ¨¡å—ï¼Œéœ€è¦ç¼–è¯‘
- pnpmå®‰å…¨æœºåˆ¶é»˜è®¤å¿½ç•¥æ„å»ºè„šæœ¬
- Windowsç¯å¢ƒä¸‹ç¼–è¯‘åŸç”Ÿæ¨¡å—éœ€è¦é¢å¤–å·¥å…·

**âœ… å·²ä¿®å¤**:
- æ›¿æ¢ä¸º `bcryptjs` (çº¯JavaScriptå®ç°)
- ä¿®æ”¹æ–‡ä»¶: `packages/server/src/utils/password.ts`
- ä¿®æ”¹å†…å®¹: `import bcrypt from 'bcryptjs'`

---

### 2. âŒ ç«¯å£å ç”¨

**é”™è¯¯ä¿¡æ¯**:
```
Error: listen EADDRINUSE: address already in use :::3001
```

**åŸå› **: ä¹‹å‰çš„åç«¯è¿›ç¨‹ä»åœ¨åå°è¿è¡Œ

**âœ… å·²ä¿®å¤**:
```cmd
taskkill //F //PID 12428
```

---

### 3. âŒ PostgreSQLè¿æ¥å¤±è´¥

**é”™è¯¯ä¿¡æ¯**:
```
Error: connect ECONNREFUSED 127.0.0.1:5432
Code: ECONNREFUSED
```

**åŸå› åˆ†æ**:
- ä½ æˆåŠŸåˆ›å»ºäº†æ•°æ®åº“ï¼ˆ`CREATE DATABASE digittwinedit`ï¼‰
- ä½†PostgreSQLæœåŠ¡å™¨è¿›ç¨‹æœªè¿è¡Œ
- åç«¯æ— æ³•è¿æ¥åˆ°5432ç«¯å£

**â¸ï¸ å¾…ä¿®å¤**:
éœ€è¦å¯åŠ¨PostgreSQLæœåŠ¡å™¨

---

## ä¿®å¤åçš„çŠ¶æ€

### âœ… å·²è§£å†³

```
âœ… å‰ç«¯æœåŠ¡å™¨: http://localhost:5173 (è¿è¡Œä¸­)
âœ… åç«¯æœåŠ¡å™¨: http://localhost:3001 (è¿è¡Œä¸­)
âœ… bcrypté—®é¢˜: å·²æ›¿æ¢ä¸ºbcryptjs
âœ… ç«¯å£å†²çª: å·²è§£å†³
âœ… ä»£ç ç¼–è¯‘: æ— é”™è¯¯
```

### â¸ï¸ å¾…è§£å†³

```
âŒ PostgreSQL: æœªè¿è¡Œï¼ˆè¿æ¥è¢«æ‹’ç»ï¼‰
```

---

## è§£å†³PostgreSQLé—®é¢˜çš„3ç§æ–¹æ¡ˆ

### ğŸš€ æ–¹æ¡ˆ1: ä½¿ç”¨Dockerï¼ˆæœ€ç®€å•ï¼Œæ¨èï¼‰

**ä¼˜ç‚¹**:
- ä¸€é”®å¯åŠ¨
- ç¯å¢ƒéš”ç¦»
- è‡ªåŠ¨é…ç½®
- æ˜“äºç®¡ç†

**æ­¥éª¤**:
```cmd
# è¿è¡Œæˆ‘åˆ›å»ºçš„è„šæœ¬
start-postgres-docker.bat
```

è¿™ä¸ªè„šæœ¬ä¼šï¼š
1. âœ“ å¯åŠ¨PostgreSQLå®¹å™¨
2. âœ“ åˆ›å»ºç”¨æˆ·å’Œæˆæƒ
3. âœ“ è¿è¡Œæ‰€æœ‰è¿ç§»è„šæœ¬
4. âœ“ éªŒè¯è¡¨åˆ›å»º

**å‰æ**: éœ€è¦å®‰è£…Docker Desktop
- ä¸‹è½½: https://www.docker.com/products/docker-desktop/

---

### ğŸ”§ æ–¹æ¡ˆ2: å¯åŠ¨å·²å®‰è£…çš„PostgreSQLæœåŠ¡

å¦‚æœä½ å·²å®‰è£…PostgreSQLï¼ˆé€šè¿‡å®‰è£…ç¨‹åºï¼‰ï¼Œéœ€è¦å¯åŠ¨æœåŠ¡ï¼š

#### WindowsæœåŠ¡æ–¹å¼

```cmd
# æ‰“å¼€æœåŠ¡ç®¡ç†å™¨
services.msc

# æ‰¾åˆ° "postgresql-x64-15" æˆ– "postgresql-x64-16"
# å³é”® -> å¯åŠ¨
```

#### å‘½ä»¤è¡Œæ–¹å¼

```cmd
# æŸ¥æ‰¾æ‰€æœ‰PostgreSQLæœåŠ¡
sc query state= all | findstr postgres

# å¯åŠ¨æœåŠ¡ï¼ˆæ›¿æ¢ä¸ºå®é™…æœåŠ¡åï¼‰
net start postgresql-x64-15
```

#### æ‰‹åŠ¨å¯åŠ¨

```cmd
# æ‰¾åˆ°PostgreSQLå®‰è£…ç›®å½•ï¼Œä¾‹å¦‚:
# C:\Program Files\PostgreSQL\15\bin

# è¿è¡Œ
"C:\Program Files\PostgreSQL\15\bin\pg_ctl.exe" -D "C:\Program Files\PostgreSQL\15\data" start
```

---

### ğŸ§ª æ–¹æ¡ˆ3: ä½¿ç”¨SQLiteï¼ˆä¸´æ—¶æµ‹è¯•ï¼‰

å¦‚æœåªæƒ³å¿«é€Ÿæµ‹è¯•ï¼Œå¯ä»¥æš‚æ—¶æ”¹ç”¨SQLiteï¼š

1. ä¿®æ”¹æ•°æ®åº“é…ç½®
2. ä½¿ç”¨better-sqlite3
3. æµ‹è¯•åŸºæœ¬åŠŸèƒ½

ï¼ˆæˆ‘å¯ä»¥å¸®ä½ å¿«é€Ÿé…ç½®ï¼‰

---

## éªŒè¯PostgreSQLè¿è¡Œ

### æµ‹è¯•è¿æ¥

```cmd
psql -U postgres -c "SELECT 1;"
```

å¦‚æœæˆåŠŸï¼Œä¼šæ˜¾ç¤º:
```
 ?column?
----------
        1
(1 row)
```

### æ£€æŸ¥ç«¯å£

```cmd
netstat -ano | findstr :5432
```

åº”è¯¥çœ‹åˆ°:
```
TCP    0.0.0.0:5432    LISTENING
```

---

## æ¨èè¡ŒåŠ¨

### ğŸ¯ æœ€å¿«çš„è§£å†³æ–¹æ¡ˆ

1. **å®‰è£…Docker Desktop** (å¦‚æœæœªå®‰è£…)
   - ä¸‹è½½å¹¶å®‰è£…
   - å¯åŠ¨Docker Desktop
   - ç­‰å¾…å®Œå…¨å¯åŠ¨ï¼ˆæ‰˜ç›˜å›¾æ ‡æ˜¾ç¤ºä¸ºç»¿è‰²ï¼‰

2. **è¿è¡ŒDockerè„šæœ¬**
   ```cmd
   start-postgres-docker.bat
   ```

3. **é‡å¯åç«¯**
   ```cmd
   # å¦‚æœåç«¯ä»åœ¨è¿è¡Œï¼Œå…ˆåœæ­¢
   # ç„¶åé‡æ–°å¯åŠ¨
   cd packages\server
   pnpm dev
   ```

4. **åˆ·æ–°æµè§ˆå™¨**
   - http://localhost:5173
   - å°è¯•æ³¨å†Œç”¨æˆ·

5. **ä½¿ç”¨DevToolsæµ‹è¯•**
   - F12æ‰“å¼€DevTools
   - Networkæ ‡ç­¾æŸ¥çœ‹APIè¯·æ±‚
   - åº”è¯¥çœ‹åˆ°200 OKè€Œä¸æ˜¯500é”™è¯¯

---

## å½“å‰ç³»ç»ŸçŠ¶æ€

```
âœ… Node.js: v22.14.0
âœ… pnpm: 10.28.1
âœ… å‰ç«¯: http://localhost:5173 (è¿è¡Œä¸­)
âœ… åç«¯: http://localhost:3001 (è¿è¡Œä¸­)
âŒ PostgreSQL: æœªè¿è¡Œ (éœ€è¦å¯åŠ¨)
âœ… ä»£ç : ç¼–è¯‘æˆåŠŸ
âœ… bcrypt: å·²ä¿®å¤ä¸ºbcryptjs
```

---

## ä¸‹ä¸€æ­¥

è¯·é€‰æ‹©ä¸€ä¸ªæ–¹æ¡ˆå¯åŠ¨PostgreSQLï¼š

**æ¨è**: è¿è¡Œ `start-postgres-docker.bat` (å¦‚æœæœ‰Docker)

**æˆ–**: æ‰‹åŠ¨å¯åŠ¨PostgreSQLæœåŠ¡

å¯åŠ¨æˆåŠŸåå‘Šè¯‰æˆ‘ï¼Œæˆ‘å°†ç«‹å³ä½¿ç”¨Chrome DevToolsæµ‹è¯•å®Œæ•´çš„èµ„äº§ç®¡ç†åŠŸèƒ½ï¼
